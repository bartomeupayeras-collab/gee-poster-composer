<!doctype html>
<html lang="ca">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>InsuLab · Poster Composer</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --line:#e6e8f0; --text:#111; --muted:#4b5563;
      --soft:#eef1f8; --danger:#b00020; --radius:16px; --shadow:0 8px 30px rgba(0,0,0,.06);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);}
    header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.92);backdrop-filter:blur(10px);border-bottom:1px solid var(--line);}
    .wrap{max-width:1320px;margin:0 auto;padding:14px 16px}
    .top{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .brandRow{display:flex;align-items:center;gap:14px;min-width:280px}
    .logos{display:flex;align-items:center;gap:12px}
    .logos img{height:46px;width:auto;display:block;}

    #brandLink{display:inline-flex; align-items:center; cursor:pointer; text-decoration:none;}
    #brandLink:focus{outline:2px solid rgba(17,17,17,.25); outline-offset:4px; border-radius:12px;}

    .hgroup h1{margin:0;font-size:16px;letter-spacing:.2px}
    .hgroup .sub{margin-top:2px;font-size:12px;color:var(--muted)}
    /* Web header: only the logo (avoid duplicated text because the logo already contains it) */
    .hgroup{display:none}
    .btns{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    button{border:0;border-radius:14px;padding:10px 12px;font-weight:800;cursor:pointer;box-shadow:0 1px 0 rgba(0,0,0,.04)}
    button.primary{background:#111;color:#fff}
    button.secondary{background:var(--soft);color:var(--text)}
    button:disabled{opacity:.55;cursor:not-allowed}
    .langTabs{display:flex;gap:8px;align-items:center}
    .tab{padding:8px 10px;border-radius:999px;border:1px solid var(--line);background:#fff;font-size:12px;font-weight:800;cursor:pointer;user-select:none}
    .tab.active{background:#111;color:#fff;border-color:#111}
    main .grid{display:grid;grid-template-columns:380px 1fr;gap:14px;align-items:start;padding:14px 16px;max-width:1320px;margin:0 auto}
    @media (max-width:980px){main .grid{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .pad{padding:12px}
    label{font-size:12px;color:#374151;display:block;margin:10px 0 6px}
    input,textarea,select{width:100%;border:1px solid #d8dbe6;border-radius:12px;padding:10px;font-size:13px;background:#fff}
    textarea{min-height:72px;resize:vertical}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pillbar{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .pill{display:flex;align-items:center;gap:8px;padding:8px 10px;border:1px solid var(--line);border-radius:999px;background:#fff;font-size:12px;user-select:none}
    .pill input{width:auto;margin:0}
    details{border-top:1px solid var(--line);background:#fbfbfe}
    details summary{list-style:none;cursor:pointer;padding:12px;font-weight:900;display:flex;align-items:center;justify-content:space-between}
    details summary::-webkit-details-marker{display:none}
    .hint{font-size:12px;color:var(--muted);line-height:1.35}
    .err{display:none;color:var(--danger);font-size:12px;white-space:pre-wrap;border-top:1px solid var(--line);background:#fff5f7;padding:10px 12px}
    .ok{font-size:12px;color:#6b7280;margin-top:10px;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:11px}
    .spin{display:inline-block;width:14px;height:14px;border-radius:999px;border:2px solid rgba(0,0,0,.15);border-top-color:rgba(0,0,0,.7);animation:r .7s linear infinite;vertical-align:-2px;margin-right:8px}
    @keyframes r{to{transform:rotate(360deg)}}
    .canvasWrap{
      padding: 12px;
      height: calc(100vh - 120px);
      min-height: 520px;
      overflow:auto;
      display:block;
    }
    canvas{
      width:100%;
      height:auto;
      background:#fff;
      border:1px solid var(--line);
      border-radius: var(--radius);
      display:block;
    }
  </style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="top">
      <div class="brandRow">
        <div class="logos" aria-label="Logos">
          <a id="brandLink" href="https://catedrainsularitat.uib.es/" target="_blank" rel="noopener noreferrer" aria-label="Càtedra de la Insularitat"><img id="logoBrand" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABLAAAAB4CAIAAABtt5xSAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE22lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI2LTAxLTA4PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPjg5MTgwZGE0LTk4ZGEtNDE4MS05NDgyLWQwMDUwNWFlYWI5NDwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5JbnN1TGFiIMK3IEPDoHRlZHJhIGRlIGxhIEluc3VsYXJpdGF0IC0gMTwvcmRmOmxpPgogICA8L3JkZjpBbHQ+CiAgPC9kYzp0aXRsZT4KIDwvcmRmOkRlc2NyaXB0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">
        </a>
        </div>

        <div class="hgroup">
          <h1 id="appTitle">InsuLab · Càtedra de la Insularitat</h1>
          <div class="sub" id="appSub"></div>
        </div>
      </div>

      <div class="btns">
        <div class="langTabs" aria-label="Idioma">
          <div class="tab active" data-lang="ca">CA</div>
          <div class="tab" data-lang="es">ES</div>
          <div class="tab" data-lang="en">EN</div>
        </div>
        <button class="secondary" id="btnReset"></button>
        <button class="primary" id="btnRender"></button>
        <button class="secondary" id="btnDownload"></button>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="grid">
    <section class="card">
      <div class="pad">
        <label id="labMap"></label>
        <input id="mapUrl" placeholder="" />
        <div class="hint" style="margin-top:6px" id="hintMulti"></div>
        <div class="row" style="margin-top:10px">
          <div style="flex:1">
            <label id="labMap2"></label>
            <input id="mapUrl2" placeholder="" />
          </div>
          <div style="flex:1">
            <label id="labMap3"></label>
            <input id="mapUrl3" placeholder="" />
          </div>
        </div>

        <div class="row">
          <div style="flex:1">
            <label id="labPosterAR"></label>
            <select id="posterAR">
              <option value="a4_land" selected>A4 horitzontal</option>
              <option value="a4_port">A4 vertical</option>
              <option value="poster">Alt (pòster)</option>
            </select>
          </div>
          <div style="flex:1">
            <label id="labPosterW"></label>
            <select id="posterW">
              <option value="2400">2400 px</option>
              <option value="3200" selected>3200 px</option>
              <option value="4000">4000 px</option>
            </select>
          </div>
          <div style="flex:1">
            <label id="labPad"></label>
            <select id="padPx">
              <option value="44">Compacte</option>
              <option value="60" selected>Normal</option>
              <option value="78">Airejat</option>
            </select>
          </div>
        </div>

        <div class="pillbar">
          <label class="pill"><input type="checkbox" id="showLegend" checked> <span id="togLegend"></span></label>
          <label class="pill"><input type="checkbox" id="dragLegend"> <span id="togDragLegend"></span></label>
          <label class="pill"><input type="checkbox" id="showNorth" checked> <span id="togNorth"></span></label>
          <label class="pill"><input type="checkbox" id="showScale"> <span id="togScale"></span></label>
          <label class="pill"><input type="checkbox" id="showFooter" checked> <span id="togFooter"></span></label>
        </div>

        <div class="row" style="margin-top:10px">
          <div style="flex:1">
            <label id="labLegendPos">Posició llegenda</label>
            <select id="legendSide">
              <option value="right" selected>Dreta</option>
              <option value="left">Esquerra</option>
            </select>
          </div>
          <div style="flex:1">
            <label id="labScalePos">Posició escala</label>
            <select id="scaleSide">
              <option value="left" selected>Esquerra</option>
              <option value="right">Dreta</option>
            </select>
          </div>
        </div>

        <div class="ok">
          <div id="status"></div>
          <div class="mono" id="fn"></div>
        </div>
      </div>

      <details id="adv" open>
        <summary>
          <span id="advTitle"></span>
</summary>
        <div class="pad">
          <label id="labTitle"></label>
          <input id="title" />

          <label id="labSubtitle"></label>
          <textarea id="subtitle"></textarea>

          
          <!-- hidden advanced fields (kept for payload compatibility) -->
          <input id="vmin" type="hidden" />
          <input id="vmax" type="hidden" />
          <input id="unit" type="hidden" />
          <input id="scaleKm" type="hidden" />
          <input id="scalePx" type="hidden" />
<!-- Paleta desactivada (ve definida pel visor/GEE) -->
          <input id="palette" type="hidden" />
          <!-- Escala desactivada (ve definida automàticament) -->
          <div class="row">
            <div style="flex:1">
              <label id="labFooter"></label>
              <input id="footer" />
            </div>
          </div>

          <div class="hint" style="margin-top:10px" id="corsHint"></div>
        </div>
      </details>

      <div class="err" id="err"></div>
    </section>

    <section class="card">
      <div class="canvasWrap">
        <canvas id="c" width="2400" height="1600"></canvas>
      </div>
    </section>
  </div>
</main>

<script>
(() => {
  const $ = (id) => document.getElementById(id);
  const qs = (k) => new URLSearchParams(location.search).get(k);

  // ---------- i18n ----------
  const I18N = {
    ca: {
      reset:"Recarregar", render:"Generar", download:"Descarregar PNG",
      map:"Mapa 1 (PNG) *", map2:"Mapa 2 (PNG)", map3:"Mapa 3 (PNG)", hintMulti:"(Opcional) Enganxa Mapes 2 i 3 per fer composició de 3 mapes, o envia-ho via payload.", posterAR:"Format", posterW:"Amplada pòster", pad:"Marge intern",
      legendPos:"Posició llegenda", scalePos:"Posició escala",
      legend:"Llegenda", dragLegend:"Moure llegenda", north:"Nord", scale:"Escala", footer:"Peu",
      adv:"Detalls", advSub:"",
      title:"Títol", subtitle:"Subtítol (1–3 línies)", min:"Min", max:"Max", unit:"Unitat",
      palette:"Paleta (hex separats per coma)", scaleKm:"Escala (km) (si activada)", scalePx:"Amplada escala (px)",
      footerLab:"Peu", cors:"Si la descàrrega falla, gairebé sempre és CORS (canvas “tainted”).",
      generating:"Generant…", done:"✅ Fet",
      missingMap:"Falta l'URL del mapa (PNG).",
      loadFail:"No s'ha pogut carregar el PNG del mapa.\n\n• Revisa que l'URL sigui correcte i no hagi expirat.\n• Pot ser CORS o permissos.\n\nProva d'obrir l'URL en una pestanya nova: si no es veu, l'URL és invàlid o ha expirat.",
      dlFail:"No s'ha pogut exportar el canvas a PNG.\n\nAixò sol ser 'tainted canvas' per CORS.\nDetall:\n",
      left:"Esquerra", right:"Dreta",
    },
    es: {
      reset:"Recargar", render:"Generar", download:"Descargar PNG",
      map:"Mapa 1 (PNG) *", map2:"Mapa 2 (PNG)", map3:"Mapa 3 (PNG)", hintMulti:"(Opcional) Pega Mapas 2 y 3 para composición de 3 mapas, o envíalo vía payload.", posterAR:"Formato", posterW:"Ancho póster", pad:"Margen interno",
      legendPos:"Posición leyenda", scalePos:"Posición escala",
      legend:"Leyenda", dragLegend:"Mover leyenda", north:"Norte", scale:"Escala", footer:"Pie",
      adv:"Detalles", advSub:"",
      title:"Título", subtitle:"Subtítulo (1–3 líneas)", min:"Mín", max:"Máx", unit:"Unidad",
      palette:"Paleta (hex separados por coma)", scaleKm:"Escala (km) (si activada)", scalePx:"Ancho escala (px)",
      footerLab:"Pie", cors:"Si la descarga falla, casi siempre es CORS (canvas “tainted”).",
      generating:"Generando…", done:"✅ Listo",
      missingMap:"Falta la URL del mapa (PNG).",
      loadFail:"No se ha podido cargar el PNG del mapa.\n\n• Revisa que la URL sea correcta y no haya expirado.\n• Puede ser CORS o permisos.\n\nPrueba a abrir la URL en una pestaña nueva: si no se ve, la URL es inválida o ha expirado.",
      dlFail:"No se ha podido exportar el canvas a PNG.\n\nEsto suele ser 'tainted canvas' por CORS.\nDetalle:\n",
      left:"Izquierda", right:"Derecha",
    },
    en: {
      reset:"Reload", render:"Generate", download:"Download PNG",
      map:"Map 1 (PNG) *", map2:"Map 2 (PNG)", map3:"Map 3 (PNG)", hintMulti:"(Optional) Paste Maps 2 & 3 for a 3-map composition, or send via payload.", posterAR:"Format", posterW:"Poster width", pad:"Inner margin",
      legend:"Legend", dragLegend:"Drag legend", north:"North", scale:"Scale", footer:"Footer",
      adv:"Details", advSub:"",
      title:"Title", subtitle:"Subtitle (1–3 lines)", min:"Min", max:"Max", unit:"Unit",
      palette:"Palette (hex, comma-separated)", scaleKm:"Scale (km) (if enabled)", scalePx:"Scale width (px)",
      footerLab:"Footer", cors:"If download fails, it’s usually CORS (tainted canvas).",
      generating:"Generating…", done:"✅ Done",
      missingMap:"Missing map URL (PNG).",
      loadFail:"Couldn't load the map PNG.\n\n• Check the URL is correct and not expired.\n• It may be CORS/permissions.\n\nTry opening the URL in a new tab: if it doesn’t show, the URL is invalid or expired.",
      dlFail:"Couldn't export the canvas to PNG.\n\nThis is usually a CORS 'tainted canvas'.\nDetail:\n",
      legendPos:"Legend position", scalePos:"Scale position",
      left:"Left", right:"Right",
    }
  };
  let LANG = qs("lang") || "ca";
  if(!I18N[LANG]) LANG = "ca";
  const t = (k) => I18N[LANG][k] || I18N.ca[k] || k;

  function applyLang() {
    $("btnReset").textContent = t("reset");
    $("btnRender").textContent = t("render");
    $("btnDownload").textContent = t("download");
    $("labMap").textContent = t("map");
    if($("labMap2")) $("labMap2").textContent = t("map2");
    if($("labMap3")) $("labMap3").textContent = t("map3");
    if($("hintMulti")) $("hintMulti").textContent = t("hintMulti");
    $("labPosterAR").textContent = t("posterAR");
    $("labPosterW").textContent = t("posterW");
    $("labPad").textContent = t("pad");
    if($("labLegendPos")) $("labLegendPos").textContent = t("legendPos");
    if($("labScalePos")) $("labScalePos").textContent = t("scalePos");
    // option labels (Left/Right) for legend/scale selects
    const setSideOptionLabels = () => {
      const legSel = $("legendSide");
      const scSel  = $("scaleSide");
      if(legSel){
        legSel.querySelectorAll("option").forEach(o=>{
          if(o.value==="left") o.textContent = t("left");
          if(o.value==="right") o.textContent = t("right");
        });
      }
      if(scSel){
        scSel.querySelectorAll("option").forEach(o=>{
          if(o.value==="left") o.textContent = t("left");
          if(o.value==="right") o.textContent = t("right");
        });
      }
    };
    setSideOptionLabels();

    $("togLegend").textContent = t("legend");
    if($("togDragLegend")) $("togDragLegend").textContent = t("dragLegend");
    $("togNorth").textContent = t("north");
    $("togScale").textContent = t("scale");
    $("togFooter").textContent = t("footer");
    $("advTitle").textContent = t("adv");
    if($("advSub")) $("advSub").textContent = t("advSub");
    $("labTitle").textContent = t("title");
    $("labSubtitle").textContent = t("subtitle");
    if($("labMin")) $("labMin").textContent = t("min");
    if($("labMax")) $("labMax").textContent = t("max");
    if($("labUnit")) $("labUnit").textContent = t("unit");
    if($("labPalette")) $("labPalette").textContent = t("palette");
    if($("labScaleKm")) $("labScaleKm").textContent = t("scaleKm");
    if($("labScalePx")) $("labScalePx").textContent = t("scalePx");
    if($("labFooter")) $("labFooter").textContent = t("footerLab");
    $("corsHint").innerHTML = t("cors") + " " + "<span class='mono'>(" + "earthengine.googleapis.com" + ")</span>";
    document.querySelectorAll(".tab").forEach(el => {
      el.classList.toggle("active", el.dataset.lang === LANG);
    });
  }

  document.querySelectorAll(".tab").forEach(el => {
    el.addEventListener("click", () => {
      LANG = el.dataset.lang;
      applyLang();
      // re-render to update any language-dependent text drawn on poster footer
      if(($("mapUrl").value||"").trim()) render();
    });
  });

  // ---------- helpers ----------
  const sanitize = (s) => (s===null || s===undefined) ? "" : String(s);
  const setIf = (id, v) => { if(v!==null && v!==undefined && v!=="") $(id).value = v; };
  const setErr = (msg) => {
    const el = $("err");
    el.style.display = msg ? "block" : "none";
    el.textContent = msg || "";
  };
  const setStatus = (html) => $("status").innerHTML = html || "";

  const parsePalette = (s) => {
    if(!s) return ["#440154","#3b528b","#21918c","#5ec962","#fde725"];
    return String(s).split(",").map(x => {
      x=(x||"").trim().replace("#","");
      if(!x) return null;
      if(x.length===3) x=x[0]+x[0]+x[1]+x[1]+x[2]+x[2];
      return "#"+x;
    }).filter(Boolean);
  };

  const slug = (s) => (String(s||"").toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
    .replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"").slice(0,90) || "poster");

  // ---------- draw primitives ----------
  function drawRoundedRect(ctx,x,y,w,h,r){
    r=Math.min(r,w/2,h/2);
    ctx.beginPath();
    ctx.moveTo(x+r,y);
    ctx.arcTo(x+w,y,x+w,y+h,r);
    ctx.arcTo(x+w,y+h,x,y+h,r);
    ctx.arcTo(x,y+h,x,y,r);
    ctx.arcTo(x,y,x+w,y,r);
    ctx.closePath();
  }
  function drawNorthArrow(ctx,x,y,size){
    ctx.save();
    ctx.translate(x,y);
    ctx.fillStyle="#111";
    ctx.beginPath();
    ctx.moveTo(0,-size);
    ctx.lineTo(size*0.55,size*0.8);
    ctx.lineTo(0,size*0.45);
    ctx.lineTo(-size*0.55,size*0.8);
    ctx.closePath();
    ctx.fill();
    ctx.fillStyle="#fff";
    ctx.beginPath();
    ctx.moveTo(0,-size*0.72);
    ctx.lineTo(size*0.25,size*0.45);
    ctx.lineTo(0,size*0.25);
    ctx.lineTo(-size*0.25,size*0.45);
    ctx.closePath();
    ctx.fill();
    ctx.fillStyle="#111";
    ctx.font="800 "+Math.round(size*0.7)+"px system-ui, sans-serif";
    ctx.textAlign="center";
    ctx.textBaseline="bottom";
    ctx.fillText("N",0,-size*1.08);
    ctx.restore();
  }
  function drawLegend(ctx,x,y,w,h,vmin,vmax,unit,palette,S){
    ctx.save();
    ctx.globalAlpha=.98;
    ctx.fillStyle="#fff";
    drawRoundedRect(ctx,x,y,w,h,Math.round(18*S));
    ctx.fill();
    ctx.globalAlpha=1;
    ctx.strokeStyle="rgba(0,0,0,0.10)";
    ctx.lineWidth=Math.max(1,Math.round(2*S));
    drawRoundedRect(ctx,x,y,w,h,Math.round(18*S));
    ctx.stroke();

    // Compact legend layout (less whitespace)
    const pad = Math.round(14*S);

    ctx.fillStyle="#111";
    ctx.font="900 "+Math.round(26*S)+"px system-ui, sans-serif";
    ctx.textAlign="left";
    ctx.textBaseline="top";
    ctx.fillText(unit || t("legend"), x+pad, y+Math.round(10*S));

    const barX=x+pad, barY=y+Math.round(56*S), barW=w-(pad*2), barH=Math.round(16*S);
    const grad=ctx.createLinearGradient(barX,0,barX+barW,0);
    const stops=Math.max(1,palette.length-1);
    for(let i=0;i<palette.length;i++) grad.addColorStop(i/stops, palette[i]);
    ctx.fillStyle=grad;
    drawRoundedRect(ctx,barX,barY,barW,barH,Math.round(8*S));
    ctx.fill();

    // Values (bigger for readability)
    ctx.fillStyle="#333";
    ctx.font="900 "+Math.round(24*S)+"px system-ui, sans-serif";
    ctx.textBaseline="top";
    const vy = barY + barH + Math.round(10*S);
    ctx.textAlign="left";
    ctx.fillText(sanitize(vmin), barX, vy);
    ctx.textAlign="right";
    ctx.fillText(sanitize(vmax), barX+barW, vy);

    ctx.restore();
  }
  function drawScaleBar(ctx,x,y,widthPx,label,S){
    ctx.save();
    ctx.fillStyle="#111";
    ctx.strokeStyle="#111";
    ctx.lineWidth=Math.max(1,Math.round(2*S));
    ctx.beginPath(); ctx.moveTo(x,y); ctx.lineTo(x+widthPx,y); ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x,y-Math.round(8*S)); ctx.lineTo(x,y+Math.round(8*S));
    ctx.moveTo(x+widthPx,y-Math.round(8*S)); ctx.lineTo(x+widthPx,y+Math.round(8*S));
    ctx.stroke();
    ctx.font="900 "+Math.round(20*S)+"px system-ui, sans-serif";
    ctx.textAlign="center"; ctx.textBaseline="bottom";
    ctx.fillText(label, x+widthPx/2, y-Math.round(10*S));
    ctx.restore();
  }

  // ---------- payload / params ----------
  const initial = {
    mapUrl:"", title:"", subtitle:"", vmin:"", vmax:"", unit:"", palette:"",
    scaleKm:"", scalePx:"", footer:"", filename:"poster.png",
    bbox:null,
    dims:null
  };

  function loadFromQuery(){
    // preferred: ?p=
    const p = qs("p");
    if(p){
      try{
        let payload=null;
        try{ payload=JSON.parse(p); }
        catch(_e1){
          try{ payload=JSON.parse(decodeURIComponent(p)); }
          catch(_e2){
            // Some launchers may base64-encode the payload
            try{ payload=JSON.parse(atob(p)); }
            catch(_e3){ payload=JSON.parse(atob(decodeURIComponent(p))); }
          }
        }
        initial.mapUrl = payload.dataUrl || payload.mapUrl || payload.map || payload.url || "";
        // Multi-map support (3 maps)
        if(Array.isArray(payload.maps)){
          window.__PAYLOAD_MAPS = payload.maps.slice(0,3);
        } else {
          window.__PAYLOAD_MAPS = null;
        }
        if(Array.isArray(payload.labels)){
          window.__PAYLOAD_LABELS = payload.labels.slice(0,3);
        } else {
          window.__PAYLOAD_LABELS = null;
        }
        // Optional: map bbox & dims for a real scale bar
        if(payload.bbox && isFinite(payload.bbox.w) && isFinite(payload.bbox.e) && isFinite(payload.bbox.s) && isFinite(payload.bbox.n)){
          initial.bbox = payload.bbox;
        }
        if(payload.dims && isFinite(payload.dims.w) && isFinite(payload.dims.h)){
          initial.dims = payload.dims;
        }
        initial.title = payload.title || payload.meta?.island || payload.island || payload.islandName || payload.name || "Comparador insular";
        let sub = payload.subtitle || "";
        if(!sub && payload.meta){
          const m = payload.meta;
          const parts=[];
          if(m.mode) parts.push(m.mode);
          if(m.map) parts.push(m.map);
          if(m.island) parts.push(m.island);
          if(m.date) parts.push(m.date);
          sub = parts.join(" · ");
        }
        initial.subtitle = sub;

        if(payload.meta){
          if(payload.meta.min!==null && payload.meta.min!==undefined) initial.vmin = String(payload.meta.min);
          if(payload.meta.max!==null && payload.meta.max!==undefined) initial.vmax = String(payload.meta.max);
          initial.unit = payload.meta.unit || "";
          if(Array.isArray(payload.meta.palette)) initial.palette = payload.meta.palette.join(",");
        }
        const f = [
          payload.meta?.island || "",
          payload.subtitle || payload.meta?.map || "",
          payload.meta?.date || "",
          payload.meta?.mode || ""
        ].filter(Boolean).join("_");
        initial.filename = slug(f || payload.title || "poster") + ".png";
      }catch(_e){ /* ignore */ }
    }

    if(!initial.mapUrl) initial.mapUrl = qs("map") || qs("mapUrl") || qs("url") || qs("dataUrl") || "";
    if(!initial.title) initial.title = qs("title") || initial.title;
    if(!initial.subtitle) initial.subtitle = qs("subtitle") || initial.subtitle;
    if(!initial.vmin) initial.vmin = qs("min") || "";
    if(!initial.vmax) initial.vmax = qs("max") || "";
    if(!initial.unit) initial.unit = qs("unit") || "";
    if(!initial.palette) initial.palette = qs("palette") || "";
    initial.scaleKm = qs("scalekm") || "";
    initial.scalePx = qs("scalepx") || "";
    initial.footer = qs("footer") || "";

    setIf("mapUrl", initial.mapUrl);
    setIf("title", initial.title);
    setIf("subtitle", initial.subtitle);
    setIf("vmin", initial.vmin);
    setIf("vmax", initial.vmax);
    setIf("unit", initial.unit);
    setIf("palette", initial.palette);
    setIf("scaleKm", initial.scaleKm);
    setIf("scalePx", initial.scalePx || "180");
    setIf("footer", initial.footer);

    $("fn").textContent = initial.filename || "";
  }

  // ---------- render ----------
  const canvas = $("c");
  const ctx = canvas.getContext("2d");

  // ---------- draggable legend state ----------
  let LEGEND_POS = null;
  let LAST_LEGEND_BOX = null;
  let LEGEND_DRAGGING = false;
  let LEGEND_DRAG_OFFSET = {x:0, y:0};
  let LEGEND_DRAG_INITED = false;

  function clamp(v, a, b){
    v = Number(v);
    if(!isFinite(v)) return a;
    return Math.max(a, Math.min(b, v));
  }

  function pointerPos(evt){
    const r = canvas.getBoundingClientRect();
    const cx = (evt.clientX !== undefined) ? evt.clientX : (evt.touches && evt.touches[0] ? evt.touches[0].clientX : 0);
    const cy = (evt.clientY !== undefined) ? evt.clientY : (evt.touches && evt.touches[0] ? evt.touches[0].clientY : 0);
    return {x: cx - r.left, y: cy - r.top};
  }

  function hitLegend(p){
    if(!LAST_LEGEND_BOX) return false;
    return (p.x >= LAST_LEGEND_BOX.x && p.x <= LAST_LEGEND_BOX.x + LAST_LEGEND_BOX.w &&
            p.y >= LAST_LEGEND_BOX.y && p.y <= LAST_LEGEND_BOX.y + LAST_LEGEND_BOX.h);
  }

  function initLegendDrag(){
    if(LEGEND_DRAG_INITED) return;
    LEGEND_DRAG_INITED = true;

    function onDown(evt){
      const dragLegend = ($("dragLegend") && $("dragLegend").checked);
      const showLegend = ($("showLegend") && $("showLegend").checked);
      if(!dragLegend || !showLegend) return;
      const p = pointerPos(evt);
      if(!hitLegend(p)) return;
      evt.preventDefault();
      LEGEND_DRAGGING = true;
      if(!LEGEND_POS && LAST_LEGEND_BOX){
        LEGEND_POS = {x: LAST_LEGEND_BOX.x, y: LAST_LEGEND_BOX.y};
      }
      LEGEND_DRAG_OFFSET.x = p.x - (LEGEND_POS ? LEGEND_POS.x : 0);
      LEGEND_DRAG_OFFSET.y = p.y - (LEGEND_POS ? LEGEND_POS.y : 0);
    }

    function onMove(evt){
      if(!LEGEND_DRAGGING) return;
      const p = pointerPos(evt);
      evt.preventDefault();
      if(!LAST_LEGEND_BOX) return;

      const minX = LAST_LEGEND_BOX.mapX + LAST_LEGEND_BOX.margin;
      const maxX = LAST_LEGEND_BOX.mapX + LAST_LEGEND_BOX.mapW - LAST_LEGEND_BOX.w - LAST_LEGEND_BOX.margin;
      const minY = LAST_LEGEND_BOX.mapY + LAST_LEGEND_BOX.margin;
      const maxY = LAST_LEGEND_BOX.mapY + LAST_LEGEND_BOX.mapH - LAST_LEGEND_BOX.h - LAST_LEGEND_BOX.margin;

      LEGEND_POS.x = clamp(p.x - LEGEND_DRAG_OFFSET.x, minX, maxX);
      LEGEND_POS.y = clamp(p.y - LEGEND_DRAG_OFFSET.y, minY, maxY);

      requestAnimationFrame(()=>{ render(); });
    }

    function onUp(){ LEGEND_DRAGGING = false; }

    canvas.addEventListener("pointerdown", onDown, {passive:false});
    window.addEventListener("pointermove", onMove, {passive:false});
    window.addEventListener("pointerup", onUp, {passive:true});
    canvas.addEventListener("touchstart", onDown, {passive:false});
    window.addEventListener("touchmove", onMove, {passive:false});
    window.addEventListener("touchend", onUp, {passive:true});
  }



  function setCanvasSize(outW,outH){
    const dpr=Math.max(1, Math.floor(window.devicePixelRatio||1));
    canvas.width=outW*dpr;
    canvas.height=outH*dpr;
    ctx.setTransform(dpr,0,0,dpr,0,0);
  }

  function loadImage(url, tryCORS=true){
    return new Promise((resolve,reject)=>{
      const img=new Image();
      if(tryCORS) img.crossOrigin="anonymous";
      img.onload=()=>resolve(img);
      img.onerror=()=>reject(new Error("img_load_fail"));
      img.src=url;
    });
  }

  // Expand bbox/region in a GEE thumb URL (if editable) to avoid tight cropping.
  // If the PNG is already cropped server-side without bbox/region params, this won't help (composer can't invent pixels).
  function expandThumbUrl(url, padFrac){
    try{
      const u = new URL(url, window.location.href);
      const p = u.searchParams;

      const pad = (isFinite(padFrac) && padFrac>0) ? padFrac : 0.08;

      // bbox=minLon,minLat,maxLon,maxLat
      if(p.has('bbox')){
        const parts = p.get('bbox').split(',').map(s=>parseFloat(s.trim()));
        if(parts.length===4 && parts.every(n=>isFinite(n))){
          let [minx,miny,maxx,maxy]=parts;
          const dx=(maxx-minx)*pad, dy=(maxy-miny)*pad;
          minx-=dx; maxx+=dx; miny-=dy; maxy+=dy;
          p.set('bbox', [minx,miny,maxx,maxy].join(','));
          return u.toString();
        }
      }

      // region=<json polygon>  (common for ee.Image.getThumbURL)
      if(p.has('region')){
        const raw = p.get('region') || '';
        let obj=null;
        try{ obj = JSON.parse(raw); } catch(e){
          try{ obj = JSON.parse(decodeURIComponent(raw)); } catch(_e2){ obj=null; }
        }
        if(obj){
          const coords=[];
          (function walk(o){
            if(Array.isArray(o)){
              if(o.length===2 && typeof o[0]==='number' && typeof o[1]==='number'){
                coords.push(o);
              } else {
                o.forEach(walk);
              }
            }
          })(obj);
          if(coords.length){
            let minx=Infinity,miny=Infinity,maxx=-Infinity,maxy=-Infinity;
            coords.forEach(c=>{
              minx=Math.min(minx,c[0]); maxx=Math.max(maxx,c[0]);
              miny=Math.min(miny,c[1]); maxy=Math.max(maxy,c[1]);
            });
            const dx=(maxx-minx)*pad, dy=(maxy-miny)*pad;
            minx-=dx; maxx+=dx; miny-=dy; maxy+=dy;

            const rect = [[[ [minx,miny],[maxx,miny],[maxx,maxy],[minx,maxy],[minx,miny] ]]];
            p.set('region', JSON.stringify(rect));
            return u.toString();
          }
        }
      }

      return url;
    } catch(e){
      return url;
    }
  }



  // distance in km between two lon/lat points (WGS84, haversine)
  function haversineKm(lon1, lat1, lon2, lat2){
    const toRad = (d)=>d*Math.PI/180;
    const R = 6371.0088;
    const dLat = toRad(lat2-lat1);
    const dLon = toRad(lon2-lon1);
    const a = Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
    return 2*R*Math.asin(Math.min(1, Math.sqrt(a)));
  }

  // Pick a "nice" scale length close to target (1/2/5 * 10^n)
  function niceKm(targetKm){
    if(!isFinite(targetKm) || targetKm<=0) return null;
    const p = Math.pow(10, Math.floor(Math.log10(targetKm)));
    const n = targetKm / p;
    const m = (n<1.5)?1 : (n<3.5)?2 : (n<7.5)?5 : 10;
    return m*p;
  }

  async function render(){
    setErr("");
    $("btnRender").disabled=true;
    setStatus('<span class="spin"></span>'+t("generating"));

    try{
            // Map URL(s): support single map and 3-map compositions
      const mapUrl1 = ($("mapUrl").value||"").trim();
      const mapUrl2 = ($("mapUrl2") ? ($("mapUrl2").value||"").trim() : "");
      const mapUrl3 = ($("mapUrl3") ? ($("mapUrl3").value||"").trim() : "");

      let mapUrls = [];
      if(window.__PAYLOAD_MAPS && Array.isArray(window.__PAYLOAD_MAPS)){
        mapUrls = window.__PAYLOAD_MAPS.map(u=>String(u||"").trim()).filter(Boolean).slice(0,3);
      } else {
        mapUrls = [mapUrl1, mapUrl2, mapUrl3].filter(Boolean);
      }

      if(!mapUrls.length){
        setErr(t("missingMap"));
        return;
      }

      const mapLabels = (window.__PAYLOAD_LABELS && Array.isArray(window.__PAYLOAD_LABELS)) ? window.__PAYLOAD_LABELS : [];

      async function loadOne(url){
        let u = expandThumbUrl(url, 0.10);
        try{ return await loadImage(u, true); }
        catch(_e1){
          try{ return await loadImage(u, false); }
          catch(_e2){ throw new Error("img_load_fail"); }
        }
      }

      // load map(s)
      let imgs=[];
      try{
        imgs = await Promise.all(mapUrls.map(loadOne));
      }catch(_e){
        setErr(t("loadFail"));
        return;
      }

const W=outW, H=outH;
    ctx.clearRect(0,0,W,H);
    ctx.fillStyle="#fff"; ctx.fillRect(0,0,W,H);

    // header
    const headerH = Math.round(260*S);
    ctx.fillStyle="#fff"; ctx.fillRect(0,0,W,headerH);
    ctx.strokeStyle="rgba(0,0,0,0.06)";
    ctx.beginPath(); ctx.moveTo(0,headerH); ctx.lineTo(W,headerH); ctx.stroke();

      // poster header (single brand logo + title/subtitle)
      const logoH = Math.round(120*S);
      const brandImg = $("logoBrand");
      const yLogo = Math.round(70*S);
      const brandW = Math.round((brandImg.naturalWidth / brandImg.naturalHeight) * logoH);
      ctx.drawImage(brandImg, pad, yLogo, brandW, logoH);

      const titleX = pad;
      const titleY = yLogo + logoH + Math.round(42*S);
      ctx.textAlign = "left";
      ctx.textBaseline = "top";
      ctx.fillStyle = "#111";
      ctx.font = "900 " + Math.round(60*S) + "px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif";
      ctx.fillText(title || "", titleX, titleY);

      let afterHeaderTextY = titleY + Math.round(64*S);
      if(subtitle){
        ctx.fillStyle = "#374151";
        ctx.font = "500 " + Math.round(32*S) + "px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif";
        const lines = subtitle.split("\n").slice(0,3);
        for(let i=0;i<lines.length;i++){
          ctx.fillText(lines[i], titleX, titleY + Math.round(66*S) + i*Math.round(36*S));
        }
        afterHeaderTextY = titleY + Math.round(66*S) + lines.length*Math.round(36*S);
      }

      // map frame region (start after header/text)
      const mapTop = Math.max(headerH, Math.round(afterHeaderTextY + 34*S));
    const mapX = pad;
    const mapY = mapTop;
    const mapW = W - pad*2;
    const mapH = H - mapTop - (showFooter ? Math.round(130*S) : Math.round(70*S));

    // inner padding so the map content never touches the frame
    const inset = Math.round(18*S);
    const innerX = mapX + inset;
    const innerY = mapY + inset;
    const innerW = mapW - inset*2;
    const innerH = mapH - inset*2;

    // Map drawing (single map or 3-map layout)
    const ZOOM = 1.12;

    function drawOneMap(img, rx, ry, rw, rh, label){
      const insetLocal = Math.round(14*S);
      const innerRX = rx + insetLocal;
      const innerRY = ry + insetLocal;
      const innerRW = rw - insetLocal*2;
      const innerRH = rh - insetLocal*2;

      const ar = img.width / img.height;
      const targetAr = innerRW / innerRH;
      let drawW, drawH, dx, dy;

      if(ar > targetAr){
        drawW = innerRW;
        drawH = innerRW / ar;
        dx = innerRX;
        dy = innerRY + (innerRH - drawH)/2;
      } else {
        drawH = innerRH;
        drawW = innerRH * ar;
        dx = innerRX + (innerRW - drawW)/2;
        dy = innerRY;
      }

      const cx = dx + drawW/2;
      const cy = dy + drawH/2;
      drawW = drawW * ZOOM;
      drawH = drawH * ZOOM;
      dx = cx - drawW/2;
      dy = cy - drawH/2;

      ctx.fillStyle = "#ffffff";
      drawRoundedRect(ctx, rx, ry, rw, rh, Math.round(18*S));
      ctx.fill();
      ctx.strokeStyle="rgba(0,0,0,0.12)";
      ctx.lineWidth=Math.max(1,Math.round(2*S));
      drawRoundedRect(ctx, rx, ry, rw, rh, Math.round(18*S));
      ctx.stroke();

      ctx.save();
      drawRoundedRect(ctx, rx, ry, rw, rh, Math.round(18*S));
      ctx.clip();
      ctx.drawImage(img, dx, dy, drawW, drawH);
      ctx.restore();

      if(label){
        ctx.save();
        ctx.fillStyle="rgba(255,255,255,.92)";
        const lh = Math.round(40*S);
        const lw = Math.min(rw - Math.round(16*S), Math.round(520*S));
        const lx = rx + Math.round(10*S);
        const ly = ry + Math.round(10*S);
        drawRoundedRect(ctx, lx, ly, lw, lh, Math.round(14*S));
        ctx.fill();
        ctx.strokeStyle="rgba(0,0,0,0.10)";
        ctx.lineWidth=Math.max(1,Math.round(2*S));
        drawRoundedRect(ctx, lx, ly, lw, lh, Math.round(14*S));
        ctx.stroke();
        ctx.fillStyle="#111";
        ctx.font="900 "+Math.round(20*S)+"px system-ui, sans-serif";
        ctx.textAlign="left";
        ctx.textBaseline="middle";
        ctx.fillText(String(label).slice(0,40), lx+Math.round(14*S), ly+lh/2);
        ctx.restore();
      }

      return {drawW, drawH, dx, dy};
    }

    // container frame
    ctx.fillStyle = "#cfe8f3";
    drawRoundedRect(ctx, mapX, mapY, mapW, mapH, Math.round(22*S));
    ctx.fill();
    ctx.strokeStyle="rgba(0,0,0,0.12)";
    ctx.lineWidth=Math.max(1,Math.round(2*S));
    drawRoundedRect(ctx, mapX, mapY, mapW, mapH, Math.round(22*S));
    ctx.stroke();

    let firstDrawW = null;

    if(imgs.length >= 3){
      const gap = Math.round(18*S);
      const arSel2 = ($("posterAR") && $("posterAR").value) ? $("posterAR").value : "poster";
      const isLand = (arSel2==="a4_land");
      if(isLand){
        const cellW = (innerW - gap*2) / 3;
        for(let i=0;i<3;i++){
          const rx = innerX + i*(cellW + gap);
          const ry = innerY;
          const rw = cellW;
          const rh = innerH;
          const r = drawOneMap(imgs[i], rx, ry, rw, rh, mapLabels[i] || "");
          if(i===0) firstDrawW = r.drawW;
        }
      } else {
        const cellH = (innerH - gap*2) / 3;
        for(let i=0;i<3;i++){
          const rx = innerX;
          const ry = innerY + i*(cellH + gap);
          const rw = innerW;
          const rh = cellH;
          const r = drawOneMap(imgs[i], rx, ry, rw, rh, mapLabels[i] || "");
          if(i===0) firstDrawW = r.drawW;
        }
      }
    } else {
      const r = drawOneMap(imgs[0], mapX, mapY, mapW, mapH, mapLabels[0] || "");
      firstDrawW = r.drawW;
    }

// overlays
    const legendSide = ($("legendSide")? $("legendSide").value : "right");
    const scaleSide = ($("scaleSide")? $("scaleSide").value : "left");

    if(showNorth){
      drawNorthArrow(ctx, mapX + mapW - Math.round(90*S), mapY + Math.round(110*S), Math.round(34*S));
    }
      if(showScale){
        // 1) manual override
        let km = Number(scaleKm);
        // 2) auto-scale from bbox if available
        if(!(isFinite(km) && km>0) && initial.bbox){
          const b = initial.bbox;
          const midLat = (b.n + b.s)/2;
          const bboxWidthKm = haversineKm(b.w, midLat, b.e, midLat);
          // Use the actual drawn map width (drawW) to compute km/px
          const kmPerPx = bboxWidthKm / Math.max(1, (firstDrawW||1));
          const targetKm = kmPerPx * scalePx;
          km = niceKm(targetKm);
          // keep the bar visually consistent: adjust pixels to match the chosen nice km
          scalePx = Math.round(km / kmPerPx);
        }
        if(isFinite(km) && km>0){
          const scaleMargin = Math.round(34*S);
          const scaleY = mapY + mapH - scaleMargin;
          const scaleX = (scaleSide==="right") ? (mapX + mapW - scaleMargin - scalePx) : (mapX + scaleMargin);
          drawScaleBar(ctx, scaleX, scaleY, scalePx, km + " km", S);
        }
      }
    if(showLegend){
      const legW = Math.min(Math.round(620*S), Math.round(mapW * 0.42));
      const legH = Math.round(140*S);
      const legMargin = Math.round(26*S);

      let legX = (legendSide==="left")
        ? (mapX + legMargin)
        : (mapX + mapW - legW - legMargin);

      let legY = mapY + mapH - legH - legMargin;
      if(showScale && legendSide === scaleSide){
        const scaleStackH = Math.round(54*S);
        const gap = Math.round(14*S);
        legY = mapY + mapH - legH - legMargin - scaleStackH - gap;
      }
      legY = Math.max(mapY + legMargin, legY);

      const dragLegend = ($("dragLegend") && $("dragLegend").checked);

      if(dragLegend){
        if(!LEGEND_POS){ LEGEND_POS = {x: legX, y: legY}; }
        const minX = mapX + legMargin;
        const maxX = mapX + mapW - legW - legMargin;
        const minY = mapY + legMargin;
        const maxY = mapY + mapH - legH - legMargin;
        LEGEND_POS.x = clamp(LEGEND_POS.x, minX, maxX);
        LEGEND_POS.y = clamp(LEGEND_POS.y, minY, maxY);
        legX = LEGEND_POS.x;
        legY = LEGEND_POS.y;
      } else {
        LEGEND_POS = null;
      }

      LAST_LEGEND_BOX = {x: legX, y: legY, w: legW, h: legH, mapX, mapY, mapW, mapH, margin: legMargin};

      drawLegend(ctx, legX, legY, legW, legH, vmin, vmax, unit, palette, S);
    }

    if(showFooter){
      // Single footer (right aligned). If user provides a footer text, it replaces the default.
      ctx.font="650 "+Math.round(18*S)+"px system-ui, sans-serif";
      ctx.textAlign="right"; 
      ctx.textBaseline="middle";
      ctx.fillStyle="#4b5563";
      const defaultTail = (LANG==="ca") ? "Generat amb InsuLab" : (LANG==="es") ? "Generado con InsuLab" : "Generated with InsuLab";
      const tail = (footer && footer.length) ? footer : defaultTail;
      ctx.fillText(tail, W - pad, H - Math.round(52*S));
    }

      setStatus(t("done"));
    }catch(e){
      // Avoid leaving UI stuck on "Generating..."
      setErr((e && e.message) ? String(e.message) : String(e));
      setStatus("");
    }finally{
      $("btnRender").disabled=false;
    }
  }

  function download(){
    setErr("");
    try{
      const name = $("fn").textContent || "poster.png";
      const a=document.createElement("a");
      a.download=name;
      a.href=canvas.toDataURL("image/png");
      document.body.appendChild(a);
      a.click();
      a.remove();
    }catch(e){
      setErr(t("dlFail") + e);
    }
  }

  // wire
  $("btnRender").addEventListener("click", render);
  $("btnDownload").addEventListener("click", download);
  $("btnReset").addEventListener("click", () => {
    loadFromQuery();
    setErr("");
    setStatus("");
  });

  // init
  applyLang();
  loadFromQuery();
  initLegendDrag();
  if(qs("p") || qs("map")) setTimeout(render, 60);
})();
</script>
</body>
</html>
